#!/usr/bin/env python3
# adminPanel — jalankan dari folder proyek (./adminPanel)
# Pastikan file ini executable: chmod +x adminPanel

import getpass
import os
import sys

# pastikan path agar import modules bekerja
sys.path.insert(0, os.path.abspath(os.path.dirname(__file__)))

try:
    from modules import utils, admin
except Exception as e:
    print("Gagal import modules. Pastikan kamu menjalankan dari folder proyek (sintak/).")
    print("Error:", e)
    sys.exit(1)

def main():
    print("="*40)
    print("  Akses Panel Admin SINTAK (dengan autentikasi)")
    print("="*40)
    username = input("Username: ").strip()
    password = getpass.getpass("Password: ").strip()

    user = utils.find_user(username, password)
    if not user:
        print("\n❌ Username / password tidak cocok. Akses ditolak.")
        return

    if user.get("role","").lower() != "admin":
        print("\n⛔ Hanya akun dengan role 'admin' yang bisa mengakses panel ini.")
        return

    print("\n✅ Autentikasi berhasil. Mengarahkan ke Admin Panel...\n")
    # panggil menu admin yang ada di modules/admin.py
    admin.menu_admin(user)

if __name__ == "__main__":
    main()
